generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // O contrato sugere Supabase, que usa Postgres [cite: 36]
  url      = env("DATABASE_URL")
}

// Enum para definir os níveis de acesso conforme contrato 
enum Role {
  ADMIN       // Acesso total, aprova imóveis
  FUNCIONARIO // Cadastra imóveis, mas entram como pendentes
}

// Enum para o status do imóvel [cite: 33, 35]
enum PropertyStatus {
  PENDENTE   // Aguardando aprovação do Admin
  DISPONIVEL // Visível no site público
  VENDIDO
  RESERVADO
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String   // Será armazenada com hash (segurança)
  name      String
  role      Role     @default(FUNCIONARIO)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relacionamento: Um usuário (corretor) pode ter vários imóveis cadastrados
  properties Property[]
}

model Property {
  id          String         @id @default(cuid())
  titulo      String
  descricao   String
  preco       Decimal        @db.Decimal(10, 2) // Valor financeiro 
  
  // Endereço e Localização 
  cidade      String
  bairro      String
  endereco    String?
  
  quarto      Int
  banheiro    Int
  garagem     Int
  area        Float
  
  // Fotos serão URLs armazenadas (Supabase Storage) [cite: 36]
  fotos       String[] 
  
  // Controle de fluxo de publicação 
  status      PropertyStatus @default(PENDENTE)
  destaque    Boolean        @default(false) // Para a Home Page [cite: 12]

  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt

  // Relacionamento com o corretor responsável 
  corretorId  String
  corretor    User           @relation(fields: [corretorId], references: [id])
}